<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue3 Workflow Editor Test</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="./dist/vue3-workflow-editor.css">
</head>
<body>
  <div id="app">
    <div class="p-8">
      <h1 class="text-2xl font-bold mb-6">Vue3 Workflow Editor 测试</h1>
      
      <!-- 测试 WorkflowToolbar 组件 -->
      <div class="border border-gray-300 rounded-lg overflow-hidden mb-6">
        <workflow-toolbar 
          :scale="scale"
          @zoom-in="handleZoomIn"
          @zoom-out="handleZoomOut"
          @reset-zoom="handleResetZoom"
          @save="handleSave"
          @run="handleRun"
          @reset="handleReset"
          @publish="handlePublish"
        ></workflow-toolbar>
      </div>
      
      <!-- 组件信息 -->
      <div class="border border-gray-300 rounded-lg overflow-hidden">
        <h2 class="text-lg font-semibold p-4 border-b border-gray-200 bg-gray-50">组件库信息</h2>
        <div class="p-4">
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div>
              <span class="font-medium text-gray-700">已导出组件：</span>
              <ul class="mt-2 space-y-1 text-gray-600">
                <li>• WorkflowToolbar ✅</li>
                <li>• PropertyEditor ✅</li>
                <li>• PublishDialog ✅</li>
                <li>• IOEditor ✅</li>
                <li>• LLMProperties ✅</li>
                <li>• KnowledgeProperties ✅</li>
              </ul>
            </div>
            <div>
              <span class="font-medium text-gray-700">更多子组件：</span>
              <ul class="mt-2 space-y-1 text-gray-600">
                <li>• ConditionalProperties ✅</li>
                <li>• StartProperties ✅</li>
                <li>• OutputProperties ✅</li>
                <li>• SearchProperties ✅</li>
                <li>• LLMPromptEditor ✅</li>
                <li>• VariableSuggestions ✅</li>
              </ul>
            </div>
          </div>
          <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
            <p class="text-sm text-blue-800">
              <strong>注意：</strong> PropertyEditor组件需要在Vue项目中使用，依赖Pinia状态管理。
              CDN方式只能演示WorkflowToolbar组件。
            </p>
          </div>
        </div>

  <script src="./dist/vue3-workflow-editor.umd.js"></script>
  <script>
    const { createApp, ref } = Vue;
    
    // 检查 Vue3WorkflowEditor 是否正确加载
    console.log('Vue3WorkflowEditor:', window.Vue3WorkflowEditor);
    
    createApp({
      setup() {
        const scale = ref(1.0);
        const eventLogs = ref([]);
        
        const addLog = (event, data = null) => {
          eventLogs.value.unshift({
            time: new Date().toLocaleTimeString(),
            event,
            data
          });
          // 保持最多50条日志
          if (eventLogs.value.length > 50) {
            eventLogs.value = eventLogs.value.slice(0, 50);
          }
        };
        
        const handleZoomIn = () => {
          scale.value = Math.min(scale.value + 0.1, 3.0);
          addLog('缩放放大', { scale: scale.value });
        };
        
        const handleZoomOut = () => {
          scale.value = Math.max(scale.value - 0.1, 0.1);
          addLog('缩放缩小', { scale: scale.value });
        };
        
        const handleResetZoom = () => {
          scale.value = 1.0;
          addLog('重置缩放', { scale: scale.value });
        };
        
        const handleSave = () => {
          addLog('保存工作流');
        };
        
        const handleRun = (data) => {
          addLog('运行工作流', data);
        };
        
        const handleReset = () => {
          addLog('重置工作流');
        };
        
        const handlePublish = (data) => {
          addLog('发布工作流', data);
        };
        
        const clearLogs = () => {
          eventLogs.value = [];
        };
        
        return {
          scale,
          eventLogs,
          handleZoomIn,
          handleZoomOut,
          handleResetZoom,
          handleSave,
          handleRun,
          handleReset,
          handlePublish,
          clearLogs
        };
      }
    })
    .component('WorkflowToolbar', window.Vue3WorkflowEditor?.WorkflowToolbar)
    .mount('#app');
  </script>
</body>
</html>
