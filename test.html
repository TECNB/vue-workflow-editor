<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue3 Workflow Editor Test</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="./dist/vue3-workflow-editor.css">
</head>
<body>
  <div id="app">
    <div class="p-8">
      <h1 class="text-2xl font-bold mb-6">Vue3 Workflow Editor 测试</h1>
      
      <!-- 测试 WorkflowToolbar 组件 -->
      <div class="border border-gray-300 rounded-lg overflow-hidden">
        <workflow-toolbar 
          :scale="scale"
          @zoom-in="handleZoomIn"
          @zoom-out="handleZoomOut"
          @reset-zoom="handleResetZoom"
          @save="handleSave"
          @run="handleRun"
          @reset="handleReset"
          @publish="handlePublish"
        ></workflow-toolbar>
      </div>
      
      <!-- 事件日志 -->
      <div class="mt-8">
        <h2 class="text-lg font-semibold mb-4">事件日志</h2>
        <div class="bg-gray-100 p-4 rounded-lg max-h-60 overflow-y-auto">
          <div v-for="(log, index) in eventLogs" :key="index" class="mb-2 text-sm">
            <span class="text-gray-500">{{ log.time }}</span> - 
            <span class="font-medium">{{ log.event }}</span>
            <span v-if="log.data" class="text-gray-600">: {{ JSON.stringify(log.data) }}</span>
          </div>
          <div v-if="eventLogs.length === 0" class="text-gray-500 text-sm">暂无事件</div>
        </div>
      </div>
      
      <!-- 控制面板 -->
      <div class="mt-8">
        <h2 class="text-lg font-semibold mb-4">控制面板</h2>
        <div class="flex items-center space-x-4">
          <button @click="clearLogs" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
            清空日志
          </button>
          <div class="text-sm text-gray-600">
            当前缩放: {{ Math.round(scale * 100) }}%
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="./dist/vue3-workflow-editor.umd.js"></script>
  <script>
    const { createApp, ref } = Vue;
    
    createApp({
      setup() {
        const scale = ref(1.0);
        const eventLogs = ref([]);
        
        const addLog = (event, data = null) => {
          eventLogs.value.unshift({
            time: new Date().toLocaleTimeString(),
            event,
            data
          });
          // 保持最多50条日志
          if (eventLogs.value.length > 50) {
            eventLogs.value = eventLogs.value.slice(0, 50);
          }
        };
        
        const handleZoomIn = () => {
          scale.value = Math.min(scale.value + 0.1, 3.0);
          addLog('缩放放大', { scale: scale.value });
        };
        
        const handleZoomOut = () => {
          scale.value = Math.max(scale.value - 0.1, 0.1);
          addLog('缩放缩小', { scale: scale.value });
        };
        
        const handleResetZoom = () => {
          scale.value = 1.0;
          addLog('重置缩放', { scale: scale.value });
        };
        
        const handleSave = () => {
          addLog('保存工作流');
        };
        
        const handleRun = (data) => {
          addLog('运行工作流', data);
        };
        
        const handleReset = () => {
          addLog('重置工作流');
        };
        
        const handlePublish = (data) => {
          addLog('发布工作流', data);
        };
        
        const clearLogs = () => {
          eventLogs.value = [];
        };
        
        return {
          scale,
          eventLogs,
          handleZoomIn,
          handleZoomOut,
          handleResetZoom,
          handleSave,
          handleRun,
          handleReset,
          handlePublish,
          clearLogs
        };
      }
    })
    .component('WorkflowToolbar', Vue3WorkflowEditor.WorkflowToolbar)
    .mount('#app');
  </script>
</body>
</html>
